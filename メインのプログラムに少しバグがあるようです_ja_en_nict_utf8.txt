There seems to be some bugs in the main program