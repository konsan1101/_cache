What a terrible low level implementation