I finished the image processing function